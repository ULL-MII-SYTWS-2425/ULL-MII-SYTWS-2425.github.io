(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{689:function(e,t,n){"use strict";n.r(t);var s=n(9),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"deploying-a-next-js-app-to-netlify"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploying-a-next-js-app-to-netlify"}},[e._v("#")]),e._v(" Deploying a Next.js app to Netlify")]),e._v(" "),n("h2",{attrs:{id:"deploy-at-netlify-with-the-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploy-at-netlify-with-the-ui"}},[e._v("#")]),e._v(" Deploy at Netlify with the UI")]),e._v(" "),n("p",[e._v("Netlify’s Next.js Runtime configures your site on Netlify to enable key Next.js functionality.")]),e._v(" "),n("p",[e._v("It automatically generates "),n("strong",[n("a",{attrs:{href:"https://sytws.netlify.app/temas/web/serverless.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("serverless functions"),n("OutboundLink")],1)]),e._v(" that handle")]),e._v(" "),n("ul",[n("li",[e._v("server-side rendered (SSR) pages,")]),e._v(" "),n("li",[e._v("incremental static regeneration (ISR),")]),e._v(" "),n("li",[e._v("image optimization, and")]),e._v(" "),n("li",[e._v("other Next.js features.")])]),e._v(" "),n("p",[e._v("See section "),n("a",{attrs:{href:"https://docs.netlify.com/integrations/frameworks/next-js/overview/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Next.js on Netlify"),n("OutboundLink")],1),e._v("\nfor more details.")]),e._v(" "),n("h3",{attrs:{id:"make-public-your-repo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#make-public-your-repo"}},[e._v("#")]),e._v(" Make public your repo")]),e._v(" "),n("p",[e._v("Regarding prices and restrictions on deployment you can check the FAQ "),n("a",{attrs:{href:"https://www.netlify.com/pricing/private-org-repo-faq/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Organization-owned private repository FAQ"),n("OutboundLink")],1)]),e._v(" "),n("h3",{attrs:{id:"deploy-with-the-netlify-ui"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploy-with-the-netlify-ui"}},[e._v("#")]),e._v(" Deploy with the Netlify UI")]),e._v(" "),n("p",[e._v("In the Netlify UI, choose new deploy and import your GitHub repo to Netlify")]),e._v(" "),n("p",[n("img",{attrs:{src:"/images/nextjs/netlify-deploy-1.png",alt:""}})]),e._v(" "),n("p",[e._v("Click on "),n("strong",[e._v("show advanced")]),e._v(". Go to "),n("strong",[e._v("Environment Variables")]),e._v(" and add the secret:")]),e._v(" "),n("p",[n("img",{attrs:{src:"/images/nextjs/netlify-add-variable.png",alt:"netlify-add-variable"}})]),e._v(" "),n("p",[e._v("Finally, click on "),n("strong",[e._v("deploy site")]),e._v(" and after a while your site will be deployed and running:")]),e._v(" "),n("p",[n("img",{attrs:{src:"%7B%7Bsite.baseurl%7D%7D/images/nextjs/netlify-running-cookies.png",alt:""}})]),e._v(" "),n("h2",{attrs:{id:"netlify-environment-variables"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#netlify-environment-variables"}},[e._v("#")]),e._v(" Netlify Environment Variables")]),e._v(" "),n("p",[e._v("Environment variables are set and securely stored on Netlify and provided to the Next.JS server. This means we can avoid committing any sensitive values to our repository.")]),e._v(" "),n("p",[e._v("There are three ways to create site environment variables:")]),e._v(" "),n("ul",[n("li",[e._v("In the Netlify UI, create site variables under "),n("strong",[e._v("Site settings > Environment variables")]),e._v(".")]),e._v(" "),n("li",[e._v("With the Netlify CLI, use "),n("code",[e._v("env:set")]),e._v(" to create a site environment variable, and "),n("code",[e._v("env:import")]),e._v(" to import from a "),n("code",[e._v(".env")]),e._v(" file.")]),e._v(" "),n("li",[e._v("With the Netlify API, use "),n("code",[e._v("createEnvVars")]),e._v(" to create a new site environment variable.")])]),e._v(" "),n("p",[e._v("The Netlify UI reflects any changes made using the CLI (ntl) or the API and vice versa.")]),e._v(" "),n("h2",{attrs:{id:"exercise-deploy-with-the-netlify-cli"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exercise-deploy-with-the-netlify-cli"}},[e._v("#")]),e._v(" Exercise: Deploy with the Netlify CLI")]),e._v(" "),n("p",[e._v("The Netlify CLI is a command line interface that allows you to manage your Netlify sites from the terminal.")]),e._v(" "),n("h3",{attrs:{id:"install-the-netlify-cli"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#install-the-netlify-cli"}},[e._v("#")]),e._v(" Install the Netlify CLI")]),e._v(" "),n("p",[e._v("You can install it with npm:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("➜  explorers-up-and-running-with-serverless-functions git:(main) npm install netlify-cli -g\nadded 1438 packages, and audited 1439 packages in 26s\n➜  explorers-up-and-running-with-serverless-functions git:(main) npm ls -g netlify-cli\n/Users/casianorodriguezleon/.nvm/versions/node/v16.0.0/lib\n└── netlify-cli@12.2.8\n➜  explorers-up-and-running-with-serverless-functions git:(main) ✗ ntl --version\nnetlify-cli/12.2.8 darwin-x64 node-v16.0.0\n➜  explorers-up-and-running-with-serverless-functions git:(main) ✗ node --version\nv16.0.0\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("h3",{attrs:{id:"link-the-repo-to-netlify"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#link-the-repo-to-netlify"}},[e._v("#")]),e._v(" Link the repo to Netlify")]),e._v(" "),n("p",[e._v("The first step is to "),n("strong",[e._v("link")]),e._v(" the repo to Netlify. Here we are using the "),n("code",[e._v("--gitRemoteName")]),e._v(" option to specify the remote name "),n("code",[e._v("sytws")]),e._v(" of the repo.")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("➜  nextjs-solution git:(main) ✗ ntl link --gitRemoteName sytws\n\nnetlify link will connect this folder to a site on Netlify\n\n? How do you want to link this folder to a site? Use current git remote origin (https://github.com/ULL-MII-SYTWS/nextjs-solution)\n\nLooking for sites connected to 'https://github.com/ULL-MII-SYTWS/nextjs-solution'...\n\n\nDirectory Linked\n\nAdmin url: https://app.netlify.com/sites/nextjs-oai\nSite url:  https://nextjs-oai.netlify.app\n\nYou can now run other `netlify` cli commands in this directory\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("h3",{attrs:{id:"check-the-status"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#check-the-status"}},[e._v("#")]),e._v(" Check the status")]),e._v(" "),n("p",[e._v("Once we have linked the repo to Netlify, we can check the status:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("➜  nextjs-solution git:(main) ✗ ntl status\n──────────────────────┐\n Current Netlify User │\n──────────────────────┘\nName:   Casiano Rodriguez-Leon\nEmail:  crguezl@ull.edu.es\nGitHub: crguezl\nTeams:\n  Casiano Rodriguez-Leon's team: Collaborator\n────────────────────┐\n Netlify Site Info  │\n────────────────────┘\nCurrent site: nextjs-oai\nAdmin URL:    https://app.netlify.com/sites/nextjs-oai\nSite URL:     https://nextjs-oai.netlify.app\nSite Id:      blah-blah-blah-blah-blah\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br")])]),n("h3",{attrs:{id:"list-get-set-the-environment-variables"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#list-get-set-the-environment-variables"}},[e._v("#")]),e._v(" List/Get/Set the environment variables")]),e._v(" "),n("p",[e._v("We can use "),n("code",[e._v("ntl env:<subcommand>")]),e._v(" syntax to "),n("code",[e._v("list")]),e._v(", "),n("code",[e._v("set")]),e._v(" or "),n("code",[e._v("get")]),e._v("  environment variables:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("➜  nextjs-solution git:(main) ✗ ntl env:list\n1 environment variable for site nextjs-oai\n.---------------------------------------------------------------------.\n|                        Environment variables                        |\n|---------------------------------------------------------------------|\n|      Key       |                       Value                        |\n|----------------|----------------------------------------------------|\n| OPENAI_API_KEY | ************************************************** |\n'---------------------------------------------------------------------'\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br")])]),n("h3",{attrs:{id:"development-mode-with-the-netlify-cli"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#development-mode-with-the-netlify-cli"}},[e._v("#")]),e._v(" Development mode with the Netlify CLI")]),e._v(" "),n("p",[e._v("We can see  the site locally using the "),n("code",[e._v("dev")]),e._v(" command of "),n("code",[e._v("ntl")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v(" openai-quickstart-node git:(main) ✗ ntl dev\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("Since "),n("code",[e._v("ntl")]),e._v(" knows about Next.js, it will choose a suitable default configuration, it will create a "),n("code",[e._v(".netlify")]),e._v("folder:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("✗ tree -I node_modules .netlify     \n.netlify\n├── edge-functions\n│   ├── edge-shared\n│   │   ├── next-utils.ts\n│   │   ├── nextConfig.json\n│   │   └── utils.ts\n│   ├── manifest.json\n│   └── next-dev\n│       └── index.js\n├── edge-functions-import-map.json\n├── plugins\n│   ├── package-lock.json\n│   └── package.json\n└── state.json\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])]),n("p",[e._v("and it will start the Next.js server injecting the environment variables .")]),e._v(" "),n("p",[e._v("We can change the settings adding a "),n("a",{attrs:{href:"https://docs.netlify.com/configure-builds/file-based-configuration/",target:"_blank",rel:"noopener noreferrer"}},[e._v("netlify.toml"),n("OutboundLink")],1),e._v(" configuration file.")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('[[plugins]]\npackage = "@netlify/plugin-nextjs"\n\n[build]\ncommand = "npm run build"\npublish = ".next"\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br")])]),n("h3",{attrs:{id:"deploying-with-the-netlify-cli"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#deploying-with-the-netlify-cli"}},[e._v("#")]),e._v(" Deploying with the Netlify CLI")]),e._v(" "),n("p",[e._v("Netlify deploys are "),n("strong",[e._v("atomic")]),e._v(", and your site is never in an inconsistent state while you’re uploading a new deploy.")]),e._v(" "),n("p",[e._v("With File Transfer Protocol (FTP) or Amazon Simple Storage Service (S3) uploads, each file is pushed live one after the other, so you can  get into situations where a new HTML page is live before the supporting assets (images, scripts, CSS) have been uploaded. And if your connection cuts out in the middle of an upload, your site could get stuck in a broken state for a long time.")]),e._v(" "),n("p",[e._v("Here is an example of a deploy:")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("➜  openai-quickstart-node git:(main) ✗ ntl deploy --prod\nDeploy path: /Users/casianorodriguezleon/campus-virtual/2223/learning/openai-learning/openai-quickstart-node/.next\nDeploying to main site URL...\n✔ Finished hashing \n✔ CDN requesting 27 files\n✔ Finished uploading 27 assets\n✔ Deploy is live!\n\nLogs:              https://app.netlify.com/sites/nextjs-oai/deploys/6395e63207648c16d41001b7\nUnique Deploy URL: https://6395e63207648c16d41001b7--nextjs-oai.netlify.app\nWebsite URL:       https://nextjs-oai.netlify.app\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br")])]),n("p",[e._v("The "),n("code",[e._v("--prod")]),e._v(" option deploys to production, the  "),n("code",[e._v("--open")]),e._v(" flag  opens the site after deploy")])])}),[],!1,null,null,null);t.default=a.exports}}]);